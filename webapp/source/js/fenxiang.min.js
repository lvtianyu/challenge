var urlContent={};uploadOk=true;function url(){var gameId=oGetVars.gameId;if(location.href.indexOf("upload-data")!=-1){urlContent={h:serverHome+"/pages/grab-red.html?gameId="+gameId,title:"抢红包！",content:"今天挑战结束，回馈好友福利",pic:serverHome+"/source/img/fhb.png"}}else if(location.href.indexOf("challenge-detail")!=-1){if(undefined!=isChallengeFinished&&isChallengeFinished){urlContent={h:serverHome+"/pages/grab-red.html?gameId="+gameId,title:"抢红包！",content:"今天挑战结束，回馈好友福利",pic:serverHome+"/source/img/fhb.png"}}else{urlContent={h:location.href,title:"挑战“健康红包”",content:"既要红包更要健康！N倍红包给更健康的自己！",pic:serverHome+"/source/img/fheart.png"}}}else{urlContent={h:serverHome,title:"医云推出健康小活动，一起造起来!",content:"专为运动爱好者而设计，现在就体验！",pic:serverHome+"/source/img/fyd.png"}}}function isWX(){var ua=navigator.userAgent.toLowerCase();if(ua.match(/MicroMessenger/i)=="micromessenger"){return true}else{return false}}function initWxJSSDK(){var thisPageUrl=location.href;$.ajax({type:"get",url:wechaturl,data:{action:"initJSSDK",pageUrl:thisPageUrl,},dataType:dataType,beforeSend:function(XMLHttpRequest){},success:function(json){if(json.result=="ok"){var signJson=json.values;var appid=signJson.appid;var timestamp=signJson.timestamp;var noncestr=signJson.noncestr;var signature=signJson.signature;var url=signJson.url;if(wx!=undefined){wx.config({debug:false,appId:appid,timestamp:timestamp,nonceStr:noncestr,signature:signature,jsApiList:['onMenuShareTimeline','onMenuShareAppMessage','chooseWXPay','checkJsApi','chooseImage','previewImage','uploadImage','downloadImage',]})}}else{}},error:function(){},complete:function(XMLHttpRequest,textStatus){},})}if(wx!=undefined){wx.ready(function(){wx.checkJsApi({jsApiList:['onMenuShareTimeline','onMenuShareAppMessage','chooseWXPay','checkJsApi','chooseImage','previewImage','uploadImage','downloadImage',],success:function(res){}});wx.onMenuShareTimeline({title:urlContent.title,link:urlContent.h,imgUrl:urlContent.pic,dataUrl:'',trigger:function(res){},success:function(res){alert('已分享')},cancel:function(res){},fail:function(res){}});wx.onMenuShareAppMessage({title:urlContent.title,desc:urlContent.content,link:urlContent.h,imgUrl:urlContent.pic,type:'link',dataUrl:'',success:function(){},cancel:function(){}})})}$(function(){url();initWxJSSDK()})